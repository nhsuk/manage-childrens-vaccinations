<% content_for :before_main do %>
  <%= render AppBacklinkComponent.new(
    href: previous_wizard_path,
    name: "school sessions",
  ) %>
<% end %>

<% page_title = "Check and confirm details" %>

<%= h1 page_title %>

<%= render AppCardComponent.new(heading: "Session") do %>
  <%= govuk_summary_list classes: 'app-summary-list--no-bottom-border' do |summary_list|
    summary_list.with_row do |row|
      row.with_key { "School" }
      row.with_value { @session.location.name }
    end

    summary_list.with_row do |row|
      row.with_key { "Date" }
      row.with_value { @session.date.to_fs(:nhsuk_date_day_of_week) }
    end

    summary_list.with_row do |row|
      row.with_key { "Consent requests" }
      row.with_value {
        "Send #{pluralize(@session.days_between_consent_and_session, "day")} before the session"
      }
    end

    summary_list.with_row do |row|
      row.with_key { "Reminders" }
      row.with_value {
        "Send #{pluralize(@session.days_between_consent_and_reminder, "day")} after the first consent request"
      }
    end

    summary_list.with_row do |row|
      row.with_key { "Deadline for responses" }
      row.with_value {
        @session.date == @session.close_consent_at ?
          "Allow responses until the day of the session" :
          "Allow responses until #{@session.close_consent_at.to_fs(:nhsuk_date)}"
      }
    end
  end %>
<% end %>

<%= govuk_button_to "Confirm", wizard_path, method: :put %>
