<% if flash[:success].present? %>
  <%= render AppFlashSuccessComponent.new(flash[:success]) %>
<% end %>

<% content_for :before_main do %>
  <%= render AppBreadcrumbComponent.new(items: [
    { text: 'Home', href: dashboard_path },
    { text: 'School sessions', href: sessions_path },
    { text: @session.name, href: session_path(@session) },
  ]) %>
<% end %>

<%= h1 "Triage" %>

<%=
govuk_tabs title: "Patient triage", classes: 'nhsuk-tabs' do |c|
  c.with_tab(label: "Needs triage (#{ @partitioned_patient_sessions[:needs_triage].size })", classes: 'nhsuk-tabs__panel') do
    render "patients_with_triage_reasons", patient_sessions: @partitioned_patient_sessions[:needs_triage]
  end
  c.with_tab(label: "Triage complete (#{ @partitioned_patient_sessions[:triage_complete].size })", classes: 'nhsuk-tabs__panel') do
    render "patients_with_triage_reasons", patient_sessions: @partitioned_patient_sessions[:triage_complete]
  end
  c.with_tab(label: "Get consent (#{ @partitioned_patient_sessions[:get_consent].size })", classes: 'nhsuk-tabs__panel') do
    render "patients_with_dob", patient_sessions: @partitioned_patient_sessions[:get_consent]
  end
  c.with_tab(label: "No triage needed (#{ @partitioned_patient_sessions[:no_triage_needed].size })", classes: 'nhsuk-tabs__panel') do
    render "patients_with_dob", patient_sessions: @partitioned_patient_sessions[:no_triage_needed]
  end
end
%>
