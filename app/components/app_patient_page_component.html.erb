<%= if patient_session.state.in? %w[
                                  vaccinated
                                  unable_to_vaccinate
                                ]
     render AppOutcomeBannerComponent.new(
       patient_session:,
       current_user:,
     )
   else
     render AppSimpleStatusBannerComponent.new(patient_session:)
   end %>

<%= render AppCardComponent.new(heading: "Child details") do %>
  <%= render AppPatientDetailsComponent.new(patient:, session:) %>
<% end %>

<% if gillick_assessment_applicable? %>
  <%= render AppCardComponent.new(heading: "Gillick assessment") do %>
    <% if gillick_assessment_recorded? %>
      <%= govuk_summary_list(
            classes: %w[app-summary-list--no-bottom-border
                        nhsuk-u-margin-bottom-0],
          ) do |summary_list| %>
        <%= summary_list.with_row do |row| %>
          <%= row.with_key { "Are they Gillick competent?" } %>
          <%= row.with_value {
                patient_session.gillick_assessment.gillick_competent ?
                  "Yes, they are Gillick competent" :
                  "No"
              } %>
        <% end %>
        <%= summary_list.with_row do |row| %>
          <%= row.with_key { "Details of your assessment" } %>
          <%= row.with_value { patient_session.gillick_assessment.notes } %>
        <% end %>
      <% end %>
    <% else %>
      <p class="nhsuk-body">
        <%= govuk_link_to("Give your assessment",
                          new_session_patient_gillick_assessment_path(
              session_id: session.id,
              patient_id: patient.id,
              section: @section,
              tab: @tab,
            )) %>
      </p>
    <% end %>
  <% end %>
<% end %>

<%= render AppCardComponent.new(heading: "Consent") do %>
  <%= render AppConsentComponent.new(patient_session:, section:, tab:) %>
<% end %>

<% if display_health_questions? %>
  <%= render AppCardComponent.new(heading: "All answers to health questions") do
        render AppHealthQuestionsComponent.new(
          consents: @patient_session.consents,
        )
      end %>
<% end %>

<%= render AppCardComponent.new(heading: "Triage notes") do %>
  <%= render AppTriageNotesComponent.new(patient_session:) %>
<% end %>

<% if @patient_session.next_step == :triage %>
  <%= render AppCardComponent.new do %>
    <%= render AppTriageFormComponent.new(
          patient_session:,
          triage: @triage,
          section:,
          tab:,
        ) %>
  <% end %>
<% end %>

<%= render AppVaccinateFormComponent.new(
      patient_session:,
      vaccination_record: @vaccination_record,
      section: @section,
      tab: @tab,
    ) %>
