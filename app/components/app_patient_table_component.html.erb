<div class="app-patients">
  <%= govuk_table(classes: "app-patients__table") do |table| %>
    <%= table.with_caption(text: @caption, html_attributes: { class: "nhsuk-u-secondary-text-color nhsuk-u-font-weight-normal nhsuk-u-font-size-19" }) %>

    <%= table.with_head do |head| %>
      <% if @patient_sessions.any? %>
        <%= head.with_row do |row| %>
          <%= @columns.each do |column| %>
            <%= row.with_cell(
              text: column_name(column),
              html_attributes: { "data-col": column }
            ) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>

    <%= table.with_body do |body| %>
      <%= @patient_sessions.each do |patient_session| %>
        <%= body.with_row do |row| %>
          <%= @columns.each do |column| %>
            <%= row.with_cell(**column_value(patient_session, column)) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
